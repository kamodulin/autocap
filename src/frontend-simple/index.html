<!DOCTYPE html>
<html>

<head>
    <title>AutoCap - Simple Frontend</title>
    <link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>

<body>
    <div class="container max-w-5xl mx-auto my-4 px-6 sm:px-8 space-y-6">
        <h2 className="text-2xl font-medium leading-6 text-black mx-auto">
            AutoCap: Automatic Image Captioning ðŸ“¸âœ¨
        </h2>
        <input type="file" id="input-image" accept="image/*" onchange="upload_file()" />
        <img id="image-preview" style="width:100%;" />
        <div id="caption">
            <span id="caption-text"></span>
        </div>
    </div>
</body>
<script>
    axios.defaults.baseURL = 'http://localhost:5050/';

    var input_image = document.getElementById("input-image");
    var caption = document.getElementById("caption-text");
    var image_preview = document.getElementById('image-preview');

    function upload_file() {
        caption.innerHTML = "";
        image_preview.src = URL.createObjectURL(input_image.files[0]);

        var image = input_image.files[0];
        var formData = new FormData();

        var payload = {
            vision: "InceptionV3",
            language: "RNN with attention",
            image: image
        }

        for (let [key, value] of Object.entries(payload)) {
            formData.append(key, value);
        }
        axios.post('/predict', formData)
            .then(function (response) {
                var predicted_caption = response.data.caption;
                caption.innerHTML = "Caption: " + predicted_caption;

            }).catch(function (e) {
                console.log(e);
            });
    }

</script>

</html>